
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Indici di posizione e di scala &#8212; ds4psy</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Le relazioni tra variabili" href="012_correlation.html" />
    <link rel="prev" title="Analisi esplorativa dei dati" href="007_freq_distr.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">ds4psy</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Benvenuti
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Nozioni di base
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="preface.html">
   Prefazione
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="001_key_notions.html">
   Concetti chiave
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="005_measurement.html">
   La misurazione in psicologia
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="007_freq_distr.html">
   Analisi esplorativa dei dati
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Indici di posizione e di scala
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="012_correlation.html">
   Le relazioni tra variabili
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="013_eda_quickstart.html">
   Introduzione alla data analisi
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Probabilità
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="014_dice.html">
   Calcolo combinatorio
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="015_intro_prob.html">
   La logica dell’incerto
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="016_conditional_prob.html">
   Probabilità condizionata: significato, teoremi, eventi indipendenti
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="017_bayes_theorem.html">
   Il teorema di Bayes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="018_expval_var.html">
   Indici di posizione, di varianza e di associazione di variabili casuali
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="019_joint_prob.html">
   Probabilità congiunta
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="020_density_func.html">
   La densità di probabilità
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Distribuzioni di v.c.
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="022_discr_rv_distr.html">
   Distribuzioni di v.c. discrete
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="023_cont_rv_distr.html">
   Distribuzioni di v.c. continue
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="024_likelihood.html">
   La verosimiglianza
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Inferenza bayesiana
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="025_intro_bayes.html">
   Credibilità, modelli e parametri
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="026_subj_prop.html">
   Pensare ad una proporzione in termini soggettivi
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="029_conjugate_families.html">
   Distribuzioni coniugate
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="030_balance_prior_post.html">
   L’influenza della distribuzione a priori
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="036_metropolis.html">
   Approssimazione della distribuzione a posteriori
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="040_beta_binomial.html">
   Markov Chain Monte Carlo per l’inferenza bayesiana
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="050_normal_normal_mod.html">
   Inferenza su una media
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Regressione lineare
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="051_reglin_1.html">
   Introduzione
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="052_reglin_2.html">
   Regressione lineare bivariata
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="053_reglin_3.html">
   Regressione lineare con PyMC
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="054_reglin_4.html">
   Confronto tra le medie di due gruppi
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Inferenza frequentista
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="220_intro_frequentist.html">
   Legge dei grandi numeri
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="221_conf_interv.html">
   Intervallo fiduciale
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="226_test_ipotesi.html">
   Significatività statistica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="228_limiti_stat_frequentista.html">
   Limiti dell’inferenza frequentista
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="230_s_m_errors.html">
   Errori di tipo
   <em>
    m
   </em>
   (magnitude) e di tipo
   <em>
    s
   </em>
   (sign)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Bibliografia
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="z_biblio.html">
   Bibliografia
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Appendici
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="a01_math_symbols.html">
   Simbologia di base
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="a02_number_sets.html">
   Numeri binari, interi, razionali, irrazionali e reali
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="a04_summation_notation.html">
   Simbolo di somma (sommatorie)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="a05_calculus_notation.html">
   Per liberarvi dai terrori preliminari
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/ccaudek/ds4psy_2023/master?urlpath=tree/docs/011_loc_scale.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/ccaudek/ds4psy_2023"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/ccaudek/ds4psy_2023/issues/new?title=Issue%20on%20page%20%2F011_loc_scale.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/011_loc_scale.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#indici-di-tendenza-centrale">
   Indici di tendenza centrale
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#media">
     Media
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#media-spuntata">
     Media spuntata
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#moda-e-mediana">
     Moda e mediana
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#indici-di-dispersione">
   Indici di dispersione
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#indici-basati-sullordinamento-dei-dati">
     Indici basati sull’ordinamento dei dati
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#varianza">
     Varianza
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#stima-della-varianza-della-popolazione">
       Stima della varianza della popolazione
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#precisione">
     Precisione
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#deviazione-standard">
     Deviazione standard
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#interpretazione">
       Interpretazione
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#deviazione-mediana-assoluta">
     Deviazione mediana assoluta
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#indici-di-variabilita-relativi">
     Indici di variabilità relativi
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#commenti-e-considerazioni-finali">
   Commenti e considerazioni finali
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Indici di posizione e di scala</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#indici-di-tendenza-centrale">
   Indici di tendenza centrale
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#media">
     Media
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#media-spuntata">
     Media spuntata
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#moda-e-mediana">
     Moda e mediana
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#indici-di-dispersione">
   Indici di dispersione
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#indici-basati-sullordinamento-dei-dati">
     Indici basati sull’ordinamento dei dati
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#varianza">
     Varianza
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#stima-della-varianza-della-popolazione">
       Stima della varianza della popolazione
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#precisione">
     Precisione
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#deviazione-standard">
     Deviazione standard
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#interpretazione">
       Interpretazione
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#deviazione-mediana-assoluta">
     Deviazione mediana assoluta
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#indici-di-variabilita-relativi">
     Indici di variabilità relativi
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#commenti-e-considerazioni-finali">
   Commenti e considerazioni finali
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="indici-di-posizione-e-di-scala">
<h1>Indici di posizione e di scala<a class="headerlink" href="#indici-di-posizione-e-di-scala" title="Permalink to this headline">#</a></h1>
<p>L’analisi grafica esaminata in precedenza costituisce la base di
partenza di qualsivoglia analisi quantitativa dei dati. Tramite
opportune rappresentazioni grafiche possiamo individuare alcune
caratteristiche importanti di una distribuzione: per esempio, è
possibile capire se la distribuzione è simmetrica o asimmetrica; oppure
se è unimodale o multimodale. Successivamente, è necessario calcolare
degli indici numerici che descrivano in modo sintetico le
caratteristiche di base dei dati. In questo capitolo verranno introdotti
i principali indicatori della statistica descrittiva.</p>
<section id="indici-di-tendenza-centrale">
<h2>Indici di tendenza centrale<a class="headerlink" href="#indici-di-tendenza-centrale" title="Permalink to this headline">#</a></h2>
<p>Tra le misure di tendenza centrale, ovvero tra gli indici che ci
informano sui valori attorno ai quali sono prevalentemente concentrati i
dati di un campione, quella più comunemente usata è la media.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">arviz</span> <span class="k">as</span> <span class="nn">az</span>
<span class="n">RANDOM_SEED</span> <span class="o">=</span> <span class="mi">8927</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">RANDOM_SEED</span><span class="p">)</span>
<span class="n">az</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;arviz-darkgrid&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;tableau-colorblind10&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="c1"># cwd = os.getcwd()</span>
<span class="c1"># print(cwd)</span>
</pre></div>
</div>
</div>
</div>
<p>Per un’introduzione “soft” alla nozione di tendenza centrale di una
distribuzione statistica si segua il
<a class="reference external" href="https://tinystats.github.io/teacups-giraffes-and-statistics/03_mean.html">link</a>.</p>
<section id="media">
<h3>Media<a class="headerlink" href="#media" title="Permalink to this headline">#</a></h3>
<p>Tutti conosciamo la media aritmetica di <span class="math notranslate nohighlight">\(\{x_1, x_2, \dots, x_n\}\)</span>,
ovvero il numero reale <span class="math notranslate nohighlight">\(\bar{x}\)</span> definito da</p>
<div class="math notranslate nohighlight" id="equation-eq-mean">
<span class="eqno">(1)<a class="headerlink" href="#equation-eq-mean" title="Permalink to this equation">#</a></span>\[
\bar{x}=\frac{1}{n}\sum_{i=1}^n x_i.
\]</div>
<p>Nella &#64;eq-mean ho usato la notazione delle sommatorie per descrivere una
somma di valori. Questa notazione è molto usata in statistica e viene
descritta in Appendice.</p>
<p>La media gode della seguente importante proprietà: la somma degli scarti
tra ciascuna modalità <span class="math notranslate nohighlight">\(x_i\)</span> e la media aritmetica <span class="math notranslate nohighlight">\(\bar{x}\)</span> è nulla,
cioè</p>
<div class="math notranslate nohighlight" id="equation-eq-diffmeansumzero">
<span class="eqno">(2)<a class="headerlink" href="#equation-eq-diffmeansumzero" title="Permalink to this equation">#</a></span>\[
\sum_{i=1}^n (x_i - \bar{x}) = 0.\notag
\]</div>
<p>Infatti,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\sum_{i=1}^n (x_i - \bar{x}) &amp;= \sum_i x_i - \sum_i \bar{x}\notag\\
&amp;= \sum_i x_i - n \bar{x}\notag\\
&amp;= \sum_i x_i - \sum_i x_i = 0.\notag
\end{aligned}
\end{split}\]</div>
<p>Ciò ci consente di pensare alla media come al baricentro della
distribuzione.</p>
<p>Un’altra proprietà della media è la seguente. La somma dei quadrati
degli scarti tra ciascuna modalità <span class="math notranslate nohighlight">\(x_i\)</span> e una costante arbitraria <span class="math notranslate nohighlight">\(a\)</span>,
cioè</p>
<div class="math notranslate nohighlight" id="equation-eq-minsq">
<span class="eqno">(3)<a class="headerlink" href="#equation-eq-minsq" title="Permalink to this equation">#</a></span>\[
\varphi(a) = \sum_{i=1}^n (x_i - a)^2,\notag
\]</div>
<p>è minima per <span class="math notranslate nohighlight">\(a = \bar{x}\)</span>.</p>
<p>Il concetto statistico di media ha suscitato molte battute. Per esempio,
il fatto che, in media, ciascuno di noi ha un numero di gambe circa pari
a 1.9999999. Oppure, il fatto che, in media, ciascuno di noi ha un
testicolo. Ma la media ha altri problemi, oltre al fatto di ispirare
battute simili alle precedenti. In particolare, dobbiamo notare che la
media non è sempre l’indice che meglio rappresenta la tendenza centrale
di una distribuzione. In particolare, ciò non accade quando la
distribuzione è asimmetrica, o in presenza di valori anomali (<em>outlier</em>)
In tali circostanze, la tendenza centrale della distribuzione è meglio
rappresentata dalla mediana o dalla media spuntata (si veda più sotto).</p>
<p>Per fare un esempio, calcoliamo la media dei valori BDI-II separatamente per ciascuno dei due
gruppi di soggetti esaminati da <span id="id1">[<a class="reference internal" href="z_biblio.html#id10" title="Ulrike Zetsche, Paul-Christian Buerkner, and Babette Renneberg. Future expectations in clinical depression: biased or realistic? Journal of Abnormal Psychology, 128(7):678, 2019.">ZBR19</a>]</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Leggo i dati, seleziono le colonne appropriate, elimino i duplicati, rimuovo </span>
<span class="c1"># il dato mancante.</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/data.mood.csv&#39;</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;esm_id&#39;</span><span class="p">,</span><span class="s1">&#39;group&#39;</span><span class="p">,</span><span class="s1">&#39;bdi&#39;</span><span class="p">]]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">notnull</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;bdi&#39;</span><span class="p">])]</span>
<span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(66, 3)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>esm_id</th>
      <th>group</th>
      <th>bdi</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>10</td>
      <td>mdd</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>9</td>
      <td>mdd</td>
      <td>30.0</td>
    </tr>
    <tr>
      <th>30</th>
      <td>6</td>
      <td>mdd</td>
      <td>26.0</td>
    </tr>
    <tr>
      <th>46</th>
      <td>7</td>
      <td>mdd</td>
      <td>35.0</td>
    </tr>
    <tr>
      <th>65</th>
      <td>12</td>
      <td>mdd</td>
      <td>44.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1105</th>
      <td>99</td>
      <td>ctl</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1121</th>
      <td>100</td>
      <td>ctl</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>1133</th>
      <td>104</td>
      <td>ctl</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1152</th>
      <td>103</td>
      <td>ctl</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1171</th>
      <td>102</td>
      <td>ctl</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
<p>66 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>group
ctl    36
mdd    30
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;bdi&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">jitter</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;group&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot: xlabel=&#39;bdi&#39;&gt;
</pre></div>
</div>
<img alt="_images/011_loc_scale_6_1.png" src="_images/011_loc_scale_6_1.png" />
</div>
</div>
<p>Trovo le medie dei valori BDI-II dei due gruppi.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;group&#39;</span><span class="p">)[</span><span class="s1">&#39;bdi&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>group
ctl     1.6
mdd    30.9
Name: bdi, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Oppure</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;group&#39;</span><span class="p">)[</span><span class="s1">&#39;bdi&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>group</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ctl</th>
      <td>36.0</td>
      <td>1.6</td>
      <td>2.7</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>mdd</th>
      <td>30.0</td>
      <td>30.9</td>
      <td>6.6</td>
      <td>19.0</td>
      <td>26.0</td>
      <td>30.0</td>
      <td>35.0</td>
      <td>44.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bdi_mdd</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;group&quot;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;mdd&#39;</span><span class="p">][</span><span class="s1">&#39;bdi&#39;</span><span class="p">]</span>
<span class="nb">len</span><span class="p">(</span><span class="n">bdi_mdd</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>30
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="o">*</span><span class="n">bdi_mdd</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>25.0 30.0 26.0 35.0 44.0 30.0 22.0 33.0 43.0 43.0 24.0 39.0 19.0 25.0 31.0 28.0 30.0 35.0 31.0 26.0 36.0 41.0 26.0 35.0 33.0 28.0 27.0 34.0 22.0 27.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">sum</span><span class="p">(</span><span class="n">bdi_mdd</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">bdi_mdd</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>30.933333333333334
</pre></div>
</div>
</div>
</div>
<p>Si noti come abbiamo selezionato le osservazioni del gruppo <code class="docutils literal notranslate"><span class="pre">mdd</span></code>. In alternativa, si può usare la sintassi seguente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_group</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">)</span>
<span class="n">mdd_group</span> <span class="o">=</span> <span class="n">df_group</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="s1">&#39;mdd&#39;</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">mdd_group</span><span class="p">[</span><span class="s1">&#39;bdi&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>30
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="o">*</span><span class="n">mdd_group</span><span class="p">[</span><span class="s1">&#39;bdi&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>25.0 30.0 26.0 35.0 44.0 30.0 22.0 33.0 43.0 43.0 24.0 39.0 19.0 25.0 31.0 28.0 30.0 35.0 31.0 26.0 36.0 41.0 26.0 35.0 33.0 28.0 27.0 34.0 22.0 27.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="media-spuntata">
<h3>Media spuntata<a class="headerlink" href="#media-spuntata" title="Permalink to this headline">#</a></h3>
<p>La <em>media spuntata</em> <span class="math notranslate nohighlight">\(\bar{x}_t\)</span> (<em>trimmed mean</em>) non è altro che la
media dei dati calcolata considerando solo il 90% (o altra percentuale)
dei dati centrali. Per calcolare <span class="math notranslate nohighlight">\(\bar{x}_t\)</span> si ordinando i dati secondo
una sequenza crescente, <span class="math notranslate nohighlight">\(x_1 \leq x_2 \leq x_3 \leq \dots \leq x_n\)</span>, per
poi eliminare il primo 5% e l’ultimo 5% dei dati della serie così
ordinata. La media spuntata è data dalla media aritmetica dei dati
rimanenti.</p>
<p>Per fare un esempio, calcoliamo la media spuntata dei valori BDI-II per i due gruppi di
soggetti esaminati da <span id="id2">[<a class="reference internal" href="z_biblio.html#id10" title="Ulrike Zetsche, Paul-Christian Buerkner, and Babette Renneberg. Future expectations in clinical depression: biased or realistic? Journal of Abnormal Psychology, 128(7):678, 2019.">ZBR19</a>]</span> escludendo il 10% dei valori
più estremi. Iniziamo ad esaminare la numerosità di ciascun gruppo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;group&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>group
ctl    36
mdd    30
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Possiamo selezionare i dati del gruppo <code class="docutils literal notranslate"><span class="pre">mdd</span></code> nel modo seguente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;group&quot;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;mdd&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>esm_id</th>
      <th>group</th>
      <th>bdi</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>10</td>
      <td>mdd</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>9</td>
      <td>mdd</td>
      <td>30.0</td>
    </tr>
    <tr>
      <th>30</th>
      <td>6</td>
      <td>mdd</td>
      <td>26.0</td>
    </tr>
    <tr>
      <th>46</th>
      <td>7</td>
      <td>mdd</td>
      <td>35.0</td>
    </tr>
    <tr>
      <th>65</th>
      <td>12</td>
      <td>mdd</td>
      <td>44.0</td>
    </tr>
    <tr>
      <th>83</th>
      <td>16</td>
      <td>mdd</td>
      <td>30.0</td>
    </tr>
    <tr>
      <th>100</th>
      <td>21</td>
      <td>mdd</td>
      <td>22.0</td>
    </tr>
    <tr>
      <th>119</th>
      <td>18</td>
      <td>mdd</td>
      <td>33.0</td>
    </tr>
    <tr>
      <th>136</th>
      <td>20</td>
      <td>mdd</td>
      <td>43.0</td>
    </tr>
    <tr>
      <th>151</th>
      <td>22</td>
      <td>mdd</td>
      <td>43.0</td>
    </tr>
    <tr>
      <th>171</th>
      <td>23</td>
      <td>mdd</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>191</th>
      <td>25</td>
      <td>mdd</td>
      <td>39.0</td>
    </tr>
    <tr>
      <th>211</th>
      <td>24</td>
      <td>mdd</td>
      <td>19.0</td>
    </tr>
    <tr>
      <th>283</th>
      <td>31</td>
      <td>mdd</td>
      <td>25.0</td>
    </tr>
    <tr>
      <th>338</th>
      <td>30</td>
      <td>mdd</td>
      <td>31.0</td>
    </tr>
    <tr>
      <th>358</th>
      <td>37</td>
      <td>mdd</td>
      <td>28.0</td>
    </tr>
    <tr>
      <th>525</th>
      <td>48</td>
      <td>mdd</td>
      <td>30.0</td>
    </tr>
    <tr>
      <th>561</th>
      <td>45</td>
      <td>mdd</td>
      <td>35.0</td>
    </tr>
    <tr>
      <th>646</th>
      <td>55</td>
      <td>mdd</td>
      <td>31.0</td>
    </tr>
    <tr>
      <th>666</th>
      <td>50</td>
      <td>mdd</td>
      <td>26.0</td>
    </tr>
    <tr>
      <th>795</th>
      <td>63</td>
      <td>mdd</td>
      <td>36.0</td>
    </tr>
    <tr>
      <th>811</th>
      <td>62</td>
      <td>mdd</td>
      <td>41.0</td>
    </tr>
    <tr>
      <th>827</th>
      <td>65</td>
      <td>mdd</td>
      <td>26.0</td>
    </tr>
    <tr>
      <th>846</th>
      <td>66</td>
      <td>mdd</td>
      <td>35.0</td>
    </tr>
    <tr>
      <th>864</th>
      <td>68</td>
      <td>mdd</td>
      <td>33.0</td>
    </tr>
    <tr>
      <th>903</th>
      <td>78</td>
      <td>mdd</td>
      <td>28.0</td>
    </tr>
    <tr>
      <th>933</th>
      <td>80</td>
      <td>mdd</td>
      <td>27.0</td>
    </tr>
    <tr>
      <th>953</th>
      <td>81</td>
      <td>mdd</td>
      <td>34.0</td>
    </tr>
    <tr>
      <th>964</th>
      <td>85</td>
      <td>mdd</td>
      <td>22.0</td>
    </tr>
    <tr>
      <th>981</th>
      <td>84</td>
      <td>mdd</td>
      <td>27.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Calcoliamo ora la media spuntata dei due gruppi.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bdi_mdd</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;group&quot;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;mdd&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">bdi</span>
<span class="n">stats</span><span class="o">.</span><span class="n">trim_mean</span><span class="p">(</span><span class="n">bdi_mdd</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">)</span>

<span class="n">bdi_ctl</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;group&quot;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;ctl&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">bdi</span>
<span class="n">stats</span><span class="o">.</span><span class="n">trim_mean</span><span class="p">(</span><span class="n">bdi_ctl</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="moda-e-mediana">
<h3>Moda e mediana<a class="headerlink" href="#moda-e-mediana" title="Permalink to this headline">#</a></h3>
<p>In precedenza abbiamo già incontrato altri due popolari indici di
tendenza centrale: la <em>moda</em> (<em>Mo</em>), ovvero il valore centrale della
classe con la frequenza massima (può succedere che una distribuzione
abbia più mode; in tal caso si dice <em>multimodale</em> e questo operatore
perde il suo significato di indice di tendenza centrale) e la <em>mediana</em>
<span class="math notranslate nohighlight">\(\tilde{x}\)</span>.</p>
<p>Si calcolino i quantili di ordine 0.25, 0.5 e 0.75 dei valori BDI-II per
i due gruppi di soggetti di <span id="id3">[<a class="reference internal" href="z_biblio.html#id10" title="Ulrike Zetsche, Paul-Christian Buerkner, and Babette Renneberg. Future expectations in clinical depression: biased or realistic? Journal of Abnormal Psychology, 128(7):678, 2019.">ZBR19</a>]</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#create functions to calculate 0.10 and 0.90 quantiles</span>
<span class="k">def</span> <span class="nf">q1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.10</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">q3</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.90</span><span class="p">)</span>

<span class="c1">#calculate quantiles by group</span>
<span class="n">vals</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;bdi&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">q1</span><span class="p">,</span> <span class="n">q3</span><span class="p">]}</span>
<span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;group&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">bdi</th>
    </tr>
    <tr>
      <th></th>
      <th>q1</th>
      <th>q3</th>
    </tr>
    <tr>
      <th>group</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ctl</th>
      <td>0.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>mdd</th>
      <td>23.8</td>
      <td>41.2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Si noti che solitamente i software restituiscono un valore <em>interpolato</em>
del <span class="math notranslate nohighlight">\(p\)</span>-esimo quantile <span class="math notranslate nohighlight">\(q_p\)</span> <span class="math notranslate nohighlight">\((0 &lt; p &lt; 1)\)</span>, il quale viene calcolato
mediante specifiche procedure. Il risultato fornito dai software,
dunque, non sarà identico a quello trovato utilizzando la definizione
non interpolata di quantile che abbiamo presentato in precedenza. Se,
per qualche ragione, vogliamo conoscere l’algoritmo usato per la
determinazione dei quantili interpolati, dobbiamo leggere la
documentazione del software.</p>
</section>
</section>
<section id="indici-di-dispersione">
<h2>Indici di dispersione<a class="headerlink" href="#indici-di-dispersione" title="Permalink to this headline">#</a></h2>
<p>Le medie e gli indici di posizione descritti in precedenza forniscono
delle sintesi dei dati che mettono in evidenza la tendenza centrale
delle osservazioni. Tali indici, tuttavia, non considerano un aspetto
importante della distribuzione dei dati, ovvero la variabilità dei
valori numerici della variabile statistica. È dunque necessario
sintetizzare la distribuzione di una variabile statistica oltre che con
le misure di posizione anche tramite l’utilizzo di indicatori che
valutino la dispersione delle unità statistice.</p>
<p>Per un’introduzione “soft” al tema degli indici di dispersione si segua
il
<a class="reference external" href="https://tinystats.github.io/teacups-giraffes-and-statistics/04_variance.html">link</a>.</p>
<section id="indici-basati-sullordinamento-dei-dati">
<h3>Indici basati sull’ordinamento dei dati<a class="headerlink" href="#indici-basati-sullordinamento-dei-dati" title="Permalink to this headline">#</a></h3>
<p>È possibile calcolare degli indici di variabilità basati
sull’ordinamento dei dati. L’indice più ovvio è l’<em>intervallo di
variazione</em>, ovvero la distanza tra il valore massimo e il valore minimo
di una distribuzione di modalità, mentre in precedenza abbiamo già
incontrato la <em>differenza interquartile</em>. Questi due indici, però, hanno
il limite di essere calcolati sulla base di due soli valori della
distribuzione (<span class="math notranslate nohighlight">\(x_{\text{max}}\)</span> e <span class="math notranslate nohighlight">\(x_{\text{min}}\)</span>, oppure <span class="math notranslate nohighlight">\(x_{0.25}\)</span> e
<span class="math notranslate nohighlight">\(x_{0.75}\)</span>). Pertanto non utilizzano tutte le informazioni che sono
disponibili. Inoltre, l’intervallo di variazione ha il limite di essere
pesantemente influenzato dalla presenza di valori anomali.</p>
</section>
<section id="varianza">
<h3>Varianza<a class="headerlink" href="#varianza" title="Permalink to this headline">#</a></h3>
<p>Dati i limiti delle statistiche precedenti è più comune misurare la
variabilità di una variabile statistica come la dispersione dei dati
attorno ad un indice di tendenza centrale. Infatti, la misura di
variabilità di gran lunga più usata per valutare la variabilità di una
variabile statistica è senza dubbio la varianza. La varianza</p>
<div class="math notranslate nohighlight" id="equation-eq-var-descr">
<span class="eqno">(4)<a class="headerlink" href="#equation-eq-var-descr" title="Permalink to this equation">#</a></span>\[
\begin{equation}
S^2 = \frac{1}{n} \sum_{i=1}^n (x_i - \bar{x})^2
\end{equation}
\]</div>
<p>è la media dei quadrati degli scarti <span class="math notranslate nohighlight">\(x_i - \bar{x}\)</span> tra ogni valore e
la media della distribuzione.</p>
<p>La varianza è una misura di dispersione più complessa di quelle
esaminate in precedenza. È appropriata solo nel caso di distribuzioni
simmetriche e, anch’essa, è fortemente influenzata dai valori anomali.
Inoltre, è espressa in un’unità di misura che è il quadrato dell’unità
di misura dei dati originari e quindi ad essa non può essere assegnata
un’interpretazione intuitiva.</p>
<p>Calcoliamo ora varianza dei valori BDI-II per i dati di <span id="id4">[<a class="reference internal" href="z_biblio.html#id10" title="Ulrike Zetsche, Paul-Christian Buerkner, and Babette Renneberg. Future expectations in clinical depression: biased or realistic? Journal of Abnormal Psychology, 128(7):678, 2019.">ZBR19</a>]</span>. Applicando l’eq. <a class="reference internal" href="#equation-eq-var-descr">(4)</a> formula precedente, per tutto il campione abbiamo</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var_bdi</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">df</span><span class="o">.</span><span class="n">bdi</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">bdi</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">bdi</span><span class="p">)</span>
<span class="nb">round</span><span class="p">(</span><span class="n">var_bdi</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>236.2388
</pre></div>
</div>
</div>
</div>
<p>Possiamo anche usare le funzioni di <code class="docutils literal notranslate"><span class="pre">numpy</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var_bdi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">bdi</span><span class="p">)</span>
<span class="nb">round</span><span class="p">(</span><span class="n">var_bdi</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>236.2388
</pre></div>
</div>
</div>
</div>
<section id="stima-della-varianza-della-popolazione">
<h4>Stima della varianza della popolazione<a class="headerlink" href="#stima-della-varianza-della-popolazione" title="Permalink to this headline">#</a></h4>
<p>Si noti il denominatore della formula della varianza. Nell’eq.<a class="reference internal" href="#equation-eq-var-descr">(4)</a>
ho usato <span class="math notranslate nohighlight">\(n\)</span> (l’ampiezza campionaria, ovvero il numero di osservazioni
del campione). In questo modo ottengo la varianza quale <em>statistica
descrittiva</em> del campione. In alternativa, è possibile usare <span class="math notranslate nohighlight">\(n-1\)</span> al
denominatore:</p>
<div class="math notranslate nohighlight" id="equation-eq-var-stimatore">
<span class="eqno">(5)<a class="headerlink" href="#equation-eq-var-stimatore" title="Permalink to this equation">#</a></span>\[
\begin{equation}
s^2 = \frac{1}{n-1} \sum_{i=1}^n (x_i - \bar{x})^2
\end{equation}
\]</div>
<p>In questo secondo modo si trova la varianza quale <em>stimatore</em> della
varianza della popolazione. Si può dimostrare che l’&#64;eq-var-stimatore
fornisce una stima corretta (ovvero, non distorta) della varianza della
popolazione da cui abbiamo ottenuto il campione, mentre invece la
&#64;eq-var-descr fornisce (in media) una stima troppo piccola della
varianza della popolazione. Si presti attenzione alla notazione: <span class="math notranslate nohighlight">\(S^2\)</span>
per la varianza quale statistica descrittiva, <span class="math notranslate nohighlight">\(s^2\)</span> per la varianza
quale stimatore.</p>
<p>Per illustrare il punto precedente svolgiamo una simulazione.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
<p>Estraggo un campione casuale di 10 osservazioni dalla popolazione del
quoziente di intelligenza.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="mi">15</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 79.14867832  92.07314467  85.17166466 115.20456901  57.35052408
  84.46868435  83.1211222  100.47153823 105.17277888 112.69015165]
</pre></div>
</div>
</div>
</div>
<p>Calcolo la varianza con <span class="math notranslate nohighlight">\(n\)</span> al denominatore. Si noti che la “vera”
varianza del quoziente di intelligenza è <span class="math notranslate nohighlight">\(15^2\)</span> = 225.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>275.7124051469743
</pre></div>
</div>
</div>
</div>
<p>Consideriamo ora 10 campioni casuali del QI.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loc</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">scale</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">niter</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">random_samples</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">niter</span><span class="p">):</span>
    <span class="n">one_sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
    <span class="n">random_samples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">one_sample</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Il primo campione è</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">random_samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([91.75291894, 91.77065263, 99.2219824 , 99.43796309])
</pre></div>
</div>
</div>
</div>
<p>Il decimo campione è</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">random_samples</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 96.14788991, 107.47797137,  87.74300611, 103.06328317])
</pre></div>
</div>
</div>
</div>
<p>Stampiamo tutti e 10 i campioni.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">random_samples</span><span class="p">)</span>
<span class="n">rs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 91.75291894,  91.77065263,  99.2219824 ,  99.43796309],
       [ 97.39799277, 101.01821974,  98.46470261,  90.69871567],
       [126.45957398,  82.08803967, 100.81266244,  88.60142155],
       [104.53477326, 117.50145239,  89.07956919, 113.32697845],
       [ 83.2566088 ,  99.21242597,  93.14122343,  93.54365788],
       [101.68329366,  76.99358156, 104.15929979,  85.40761546],
       [ 79.15506872, 104.16067933, 116.31902444, 100.01760013],
       [103.79011227,  93.96718912,  76.88569815, 107.61425769],
       [ 67.13226885, 104.10795938,  98.77169945,  78.80950953],
       [ 96.14788991, 107.47797137,  87.74300611, 103.06328317]])
</pre></div>
</div>
</div>
</div>
<p>Per ciascun campione (ovvero, per ciascuna riga della matrice
precedente), calcoliamo la varianza usando <span class="math notranslate nohighlight">\(n\)</span> al denominatore.
Otteniamo così 10 stime della varianza della popolazione del QI.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_var</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">rs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># applichiamo la funzione su ciascuna riga</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_var</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[ 14.32523372  14.52796212 287.62417993 118.59171917  32.95459199
 127.56300437 179.52576743 141.07659954 223.2243419   55.65654351]
</pre></div>
</div>
</div>
</div>
<p>Ripetiamo ora la simulazione usando un numero di iterazioni maggiore.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">loc</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">scale</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">niter</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">random_samples</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">niter</span><span class="p">):</span>
    <span class="n">one_sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
    <span class="n">random_samples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">one_sample</span><span class="p">)</span>

<span class="n">rs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">random_samples</span><span class="p">)</span>
<span class="n">x_var</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">rs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Esaminiamo la distribuzione dei valori ottenuti.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">x_var</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot: ylabel=&#39;Count&#39;&gt;
</pre></div>
</div>
<img alt="_images/011_loc_scale_48_1.png" src="_images/011_loc_scale_48_1.png" />
</div>
</div>
<p>La stima più verosimile della varianza del QI è dato dalla media di
questa distribuzione.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x_var</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>166.61792874292888
</pre></div>
</div>
</div>
</div>
<p>Si noti che il valore medio della stima della varianza ottenuta con
l’eq.<a class="reference internal" href="#equation-eq-var-descr">(4)</a> è troppo piccolo rispetto al valore corretto di
<span class="math notranslate nohighlight">\(15^2 = 225\)</span>. Ripeto ora la simulazione usando la formula della varianza con <span class="math notranslate nohighlight">\(n-1\)</span> al
denominatore.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2023</span><span class="p">)</span>
<span class="n">loc</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">scale</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">niter</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="n">random_samples</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">niter</span><span class="p">):</span>
    <span class="n">one_sample</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
    <span class="n">random_samples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">one_sample</span><span class="p">)</span>

<span class="n">rs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">random_samples</span><span class="p">)</span>
<span class="n">x_var</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">rs</span><span class="p">,</span> <span class="n">ddof</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x_var</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>225.8105485976635
</pre></div>
</div>
</div>
</div>
<p>In questo secondo caso, il <em>valore atteso</em> della stima della varianza
trovata con <span class="math notranslate nohighlight">\(n-1\)</span> al denominatore è molto simile al valore corretto di
225.</p>
</section>
</section>
<section id="precisione">
<h3>Precisione<a class="headerlink" href="#precisione" title="Permalink to this headline">#</a></h3>
<p>Si definisce <em>precisione</em> l’inverso della varianza:</p>
<div class="math notranslate nohighlight" id="equation-eq-precision">
<span class="eqno">(6)<a class="headerlink" href="#equation-eq-precision" title="Permalink to this equation">#</a></span>\[
\tau = \frac{1}{\sigma^2}.
\]</div>
<p>Alcuni ritengono che la precisione sia più “intuitiva” della varianza
perché dice quanto sono concentrati i valori attorno alla media
piuttosto che quanto sono dispersi. In altri termini, si potrebbe
argomentare che siamo più interessati a quanto sia precisa una
misurazione piuttosto che a quanto sia imprecisa. Più sono dispersi i
valori attorno alla media (alta varianza), meno sono precisi (poca
precisione); minore è la varianza, maggiore è la precisione.</p>
<p>La precisione è uno dei due parametri naturali della distribuzione
gaussiana. Nei termini della &#64;eq-precision, la distribuzione gaussiana
(si veda il Capitolo &#64;distr-rv-cont) può essere espressa nel modo
seguente</p>
<div class="math notranslate nohighlight">
\[
{\displaystyle f(y)=\sqrt{\frac{\tau}{2\pi}} e^{-{\frac {1}{2}}\tau\left({y-\mu }\right)^{2}}},
\]</div>
<p>anziché come</p>
<div class="math notranslate nohighlight">
\[
{\displaystyle f(y)={\frac {1}{\sigma {\sqrt {2\pi }}}}e^{-{\frac {1}{2}}\left({\frac {y-\mu }{\sigma }}\right)^{2}}}.
\]</div>
</section>
<section id="deviazione-standard">
<h3>Deviazione standard<a class="headerlink" href="#deviazione-standard" title="Permalink to this headline">#</a></h3>
<p>Dato che l’unità di misura della varianza coincide con il quadrato
dell’unità di misura dei dati, la varianza è difficile da interpretare.
Questo problema si può risolvere prendendo la radice quadrata della
varianza, ottenendo così una misura espressa nell’unità di misura
originaria dei dati. Una tale misura si chiama <em>deviazione standard</em> (o
<em>scarto quadratico medio</em>, o <em>scarto tipo</em>)[1]:</p>
<div class="math notranslate nohighlight" id="equation-eq-sd-stimatore">
<span class="eqno">(7)<a class="headerlink" href="#equation-eq-sd-stimatore" title="Permalink to this equation">#</a></span>\[
s^2 = \sqrt{(n-1)^{-1} \sum_{i=1}^n (x_i - \bar{x})^2}
\]</div>
<p>Quando tutte le osservazioni sono uguali, <span class="math notranslate nohighlight">\(s = 0\)</span>, altrimenti <span class="math notranslate nohighlight">\(s &gt; 0\)</span>.</p>
<p>Come nel caso della varianza, anche la deviazione standard <span class="math notranslate nohighlight">\(s\)</span> dovrebbe
essere usata soltanto quando la media è adeguata per descrivere il
centro della distribuzione, ovvero, nel caso di distribuzioni
simmetriche. Come nel caso della media <span class="math notranslate nohighlight">\(\bar{x}\)</span>, anche la deviazione
standard è fortemente influenzata dai dati anomali, ovvero dalla
presenza di uno o di pochi dati che sono molto più distanti dalla media
rispetto agli altri valori della distribuzione.</p>
<p>Per fare un esempio, calcoliamo la deviazione standard per i valori BDI-II del campione di
<span id="id5">[<a class="reference internal" href="z_biblio.html#id10" title="Ulrike Zetsche, Paul-Christian Buerkner, and Babette Renneberg. Future expectations in clinical depression: biased or realistic? Journal of Abnormal Psychology, 128(7):678, 2019.">ZBR19</a>]</span>.</p>
<p>Applicando l’eq. <a class="reference internal" href="#equation-eq-sd-stimatore">(7)</a>, per tutto il campione abbiamo</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">bdi</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15.370060219395436
</pre></div>
</div>
</div>
</div>
<p>Per ciascun gruppo, abbiamo:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;group&#39;</span><span class="p">)[</span><span class="s1">&#39;bdi&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>group
ctl    2.707427
mdd    6.606858
Name: bdi, dtype: float64
</pre></div>
</div>
</div>
</div>
<section id="interpretazione">
<h4>Interpretazione<a class="headerlink" href="#interpretazione" title="Permalink to this headline">#</a></h4>
<p>Alla deviazione standard può essere assegnata una semplice
interpretazione: la deviazione standard è <em>simile</em> (ma non identica)
allo scarto semplice medio campionario, ovvero alla media aritmetica dei
valori assoluti degli scarti dalla media. La deviazione standard ci
dice, dunque, quanto sono distanti, in media, le singole osservazioni
dal centro della distribuzione. Un’interpretazione più precisa del
significato dello scarto tipo è fornita nel paragrafo successivo.</p>
<p>Si verifichi l’interpretazione della deviazione standard fornita sopra
usando i valori BDI-II del campione di &#64;zetschefuture2019.</p>
<p>Per questi dati la deviazione standard è</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">bdi</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>15.370060219395436
</pre></div>
</div>
</div>
</div>
<p>Lo scarto semplice medio campionario è</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">bdi</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">bdi</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>14.539944903581269
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="deviazione-mediana-assoluta">
<h3>Deviazione mediana assoluta<a class="headerlink" href="#deviazione-mediana-assoluta" title="Permalink to this headline">#</a></h3>
<p>Una misura robusta della dispersione statistica di un campione è la
<em>deviazione mediana assoluta</em> (<em>Median Absolute Deviation</em>, MAD)
definita come la mediana del valore assoluto delle deviazioni dei dati
dalla mediana, ovvero:</p>
<div class="math notranslate nohighlight" id="equation-eq-mad-def">
<span class="eqno">(8)<a class="headerlink" href="#equation-eq-mad-def" title="Permalink to this equation">#</a></span>\[
{\displaystyle \operatorname {MAD} =\operatorname {median} \left(\ \left|X_{i}-\operatorname {median} (X)\right|\ \right)}
\]</div>
<p>Nel caso di una distribuzione dei dati unimodale simmetrica di forma
campanulare (ovvero, normale) si ha che</p>
<div class="math notranslate nohighlight">
\[
{\displaystyle \text{deviazione standard} \approx 1.4826\ \operatorname {MAD} .\,}
\]</div>
<p>Pertanto, solitamente i software restituiscono il valore MAD
moltiplicato per una tale costante.</p>
<p>I dati di <span id="id6">[<a class="reference internal" href="z_biblio.html#id10" title="Ulrike Zetsche, Paul-Christian Buerkner, and Babette Renneberg. Future expectations in clinical depression: biased or realistic? Journal of Abnormal Psychology, 128(7):678, 2019.">ZBR19</a>]</span> seguono una distribuzione bimodale, per cui
il vincolo precedente non si applica. Verifichiamo dunque il principio
precedente usando un campione di dati estratto da una popolazione
normale.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<span class="mf">1.4826</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>14.919646929330339
</pre></div>
</div>
</div>
</div>
</section>
<section id="indici-di-variabilita-relativi">
<h3>Indici di variabilità relativi<a class="headerlink" href="#indici-di-variabilita-relativi" title="Permalink to this headline">#</a></h3>
<p>A volte può essere interessante effettuare un confronto fra due misure
di variabilità di grandezze incommensurabili, ovvero di caratteri
rilevati mediante differenti unità di misura. In questi casi, le misure
di variabilità precedentemente descritte si rivelano inadeguate in
quanto dipendono dall’unità di misura adottata. Diventa dunque
necessario ricorrere a particolari numeri adimensionali detti <em>indici
relativi di variabilità</em>. Il più importante di tali indici è il
<em>coefficiente di variazione</em>, ovvero il numero puro</p>
<div class="math notranslate nohighlight" id="equation-eq-cv-def">
<span class="eqno">(9)<a class="headerlink" href="#equation-eq-cv-def" title="Permalink to this equation">#</a></span>\[
C_v = \frac{\sigma}{\bar{x}}
\]</div>
<p>ottenuto dal rapporto tra la deviazione standard e la media dei dati.</p>
<p>Un altro indice relativo di variabilità è la differenza interquartile
rapportata al primo quartile, oppure al terzo quartile, oppure alla
mediana, cioè:</p>
<div class="math notranslate nohighlight">
\[
\frac{x_{0.75} - x_{0.25}}{x_{0.25}}, \qquad \frac{x_{0.75} - x_{0.25}}{x_{0.75}}, \qquad \frac{x_{0.75} - x_{0.25}}{x_{0.50}}.
\]</div>
</section>
</section>
<section id="commenti-e-considerazioni-finali">
<h2>Commenti e considerazioni finali<a class="headerlink" href="#commenti-e-considerazioni-finali" title="Permalink to this headline">#</a></h2>
<p>Le statistiche descrittive ci forniscono degli indici sintetici che
riassumono i dati, ovvero le nostre misurazioni dell’intera popolazione
o di un campione estratto da una popolazione. Le statistiche descrittive
comprendono gli indici di tendenza centrale e gli indici di dispersione.
Gli indici di tendenza centrale includono la media, la mediana e la
moda, mentre gli indici di dispersione includono la deviazione standard,
la varianza, la curtosi e l’asimmetria (questi ultimi due indici sono
definiti in relazione alla distribuzione Normale e verranno dunque
discussi in quel contesto).</p>
<p>[1] Il termine <em>standard deviation</em> è stato introdotto in statistica da
Pearson nel 1894 assieme alla lettera greca <span class="math notranslate nohighlight">\(\sigma\)</span> che lo rappresenta.
Il termine italiano “deviazione standard” ne è la traduzione più
utilizzata nel linguaggio comune; il termine dell’<a class="reference external" href="https://it.wikipedia.org/wiki/Ente_nazionale_italiano_di_unificazione">Ente Nazionale
Italiano di
Unificazione</a>
è tuttavia “scarto tipo”, definito come la radice quadrata positiva
della varianza.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="007_freq_distr.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Analisi esplorativa dei dati</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="012_correlation.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Le relazioni tra variabili</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Corrado Caudek<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>