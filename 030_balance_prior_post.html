
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>L’influenza della distribuzione a priori &#8212; ds4psy</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Approssimazione della distribuzione a posteriori" href="036_metropolis.html" />
    <link rel="prev" title="Distribuzioni coniugate" href="029_conjugate_families.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">ds4psy</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Benvenuti
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Nozioni di base
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="preface.html">
   Prefazione
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="001_key_notions.html">
   Concetti chiave
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="005_measurement.html">
   La misurazione in psicologia
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="007_freq_distr.html">
   Analisi esplorativa dei dati
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="011_loc_scale.html">
   Indici di posizione e di scala
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="012_correlation.html">
   Le relazioni tra variabili
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="013_eda_quickstart.html">
   Introduzione alla data analisi
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Probabilità
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="014_dice.html">
   Calcolo combinatorio
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="015_intro_prob.html">
   La logica dell’incerto
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="016_conditional_prob.html">
   Probabilità condizionata: significato, teoremi, eventi indipendenti
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="017_bayes_theorem.html">
   Il teorema di Bayes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="018_expval_var.html">
   Indici di posizione, di varianza e di associazione di variabili casuali
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="019_joint_prob.html">
   Probabilità congiunta
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="020_density_func.html">
   La densità di probabilità
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Distribuzioni di v.c.
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="022_discr_rv_distr.html">
   Distribuzioni di v.c. discrete
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="023_cont_rv_distr.html">
   Distribuzioni di v.c. continue
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="024_likelihood.html">
   La verosimiglianza
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Inferenza bayesiana
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="025_intro_bayes.html">
   Credibilità, modelli e parametri
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="026_subj_prop.html">
   Pensare ad una proporzione in termini soggettivi
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="029_conjugate_families.html">
   Distribuzioni coniugate
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   L’influenza della distribuzione a priori
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="036_metropolis.html">
   Approssimazione della distribuzione a posteriori
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="040_beta_binomial.html">
   Markov Chain Monte Carlo per l’inferenza bayesiana
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="050_normal_normal_mod.html">
   Inferenza su una media
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Regressione lineare
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="051_reglin_1.html">
   Introduzione
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="052_reglin_2.html">
   Regressione lineare bivariata
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="053_reglin_3.html">
   Regressione lineare con PyMC
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="054_reglin_4.html">
   Confronto tra le medie di due gruppi
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Inferenza frequentista
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="220_intro_frequentist.html">
   Legge dei grandi numeri
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="221_conf_interv.html">
   Intervallo fiduciale
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="226_test_ipotesi.html">
   Significatività statistica
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="228_limiti_stat_frequentista.html">
   Limiti dell’inferenza frequentista
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="230_s_m_errors.html">
   Errori di tipo
   <em>
    m
   </em>
   (magnitude) e di tipo
   <em>
    s
   </em>
   (sign)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Bibliografia
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="z_biblio.html">
   Bibliografia
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Appendici
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="a01_math_symbols.html">
   Simbologia di base
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="a02_number_sets.html">
   Numeri binari, interi, razionali, irrazionali e reali
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="a04_summation_notation.html">
   Simbolo di somma (sommatorie)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="a05_calculus_notation.html">
   Per liberarvi dai terrori preliminari
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/ccaudek/ds4psy_2023/master?urlpath=tree/docs/030_balance_prior_post.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/ccaudek/ds4psy_2023"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/ccaudek/ds4psy_2023/issues/new?title=Issue%20on%20page%20%2F030_balance_prior_post.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/030_balance_prior_post.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#il-test-di-benchdel">
   Il test di Benchdel
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#stessi-dati-diverse-distribuzioni-a-priori">
   Stessi dati, diverse distribuzioni a priori
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dati-diversi-stessa-distribuzione-a-priori">
   Dati diversi, stessa distribuzione a priori
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dati-diversi-diverse-distribuzioni-a-priori">
   Dati diversi, diverse distribuzioni a priori
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#collegare-le-intuizioni-alla-teoria">
   Collegare le intuizioni alla teoria
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#commenti-e-considerazioni-finali">
   Commenti e considerazioni finali
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>L’influenza della distribuzione a priori</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#il-test-di-benchdel">
   Il test di Benchdel
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#stessi-dati-diverse-distribuzioni-a-priori">
   Stessi dati, diverse distribuzioni a priori
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dati-diversi-stessa-distribuzione-a-priori">
   Dati diversi, stessa distribuzione a priori
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dati-diversi-diverse-distribuzioni-a-priori">
   Dati diversi, diverse distribuzioni a priori
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#collegare-le-intuizioni-alla-teoria">
   Collegare le intuizioni alla teoria
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#commenti-e-considerazioni-finali">
   Commenti e considerazioni finali
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="l-influenza-della-distribuzione-a-priori">
<span id="sec-prior-influence"></span><h1>L’influenza della distribuzione a priori<a class="headerlink" href="#l-influenza-della-distribuzione-a-priori" title="Permalink to this headline">#</a></h1>
<p>La notazione <span class="math notranslate nohighlight">\(p(\theta \mid y) \propto p(\theta) \ p(y \mid \theta)\)</span> rende particolarmente chiaro che la distribuzione a posteriori è un “miscuglio” della distribuzione a priori e della verosimiglianza. Prima di preoccuparci di come calcolare la distribuzione a posteriori in casi diversi dalle famiglie coniugate, cerchiamo di capire meglio cosa significa “mescolare” la distribuzione a priori e la verosimiglianza. Considereremo qui un esempio discusso da <span id="id1">[<a class="reference internal" href="z_biblio.html#id39" title="Alicia A. Johnson, Miles Ott, and Mine Dogucu. Bayes Rules! An Introduction to Bayesian Modeling with R. CRC Press, 2022.">JOD22</a>]</span>.</p>
<section id="il-test-di-benchdel">
<h2>Il test di Benchdel<a class="headerlink" href="#il-test-di-benchdel" title="Permalink to this headline">#</a></h2>
<p>Nel fumetto di Alison Bechdel <em>The Rule</em>, un personaggio afferma di guardare un film solo se soddisfa le seguenti tre regole <span id="id2">[<a class="reference internal" href="z_biblio.html#id40" title="Alison Bechdel. Dykes to watch out for. Firebrand Books, 1986.">Bec86</a>]</span>: almeno due caratteri nel film devono essere donne; queste due donne si parlano; parlano di qualcosa altro oltre a parlare di qualche uomo.</p>
<p>Questi criteri costituiscono il <em>test di Bechdel</em> per la rappresentazione delle donne nei film. <span id="id3">[<a class="reference internal" href="z_biblio.html#id39" title="Alicia A. Johnson, Miles Ott, and Mine Dogucu. Bayes Rules! An Introduction to Bayesian Modeling with R. CRC Press, 2022.">JOD22</a>]</span> pongono la seguente domanda “Quale percentuale dei film che avete visto supera il test di Bechdel?”.</p>
<p>Sia <span class="math notranslate nohighlight">\(\pi \in [0, 1]\)</span> una variabile casuale che indica la proporzione sconosciuta di film che superano il test di Bechdel. Tre amiche — la femminista, l’ignara e l’ottimista — hanno opionioni diverse su <span class="math notranslate nohighlight">\(\pi\)</span>. Riflettendo sui film che ha visto, la femminista capisce che nella maggioranza dei film mancano personaggi femminili forti. L’ignara non ricorda bene i film che ha visto, quindi non sa quanti film superano il test di Bechdel. Infine, l’ottimista pensa che, in generale, le donne siano ben rappresentate all’interno dei film: secondo lei quasi tutti i film superano il test di Bechdel. Le tre amiche hanno dunque tre modelli a priori diversi di <span class="math notranslate nohighlight">\(\pi\)</span>.</p>
<p>Abbiamo visto in precedenza come sia possibile usare la distribuzione Beta per rappresentare le credenze a priori. Ponendo la gran parte della massa della probabilità a priori su valori <span class="math notranslate nohighlight">\(\pi &lt; 0.5\)</span>, la distribuzione a priori <span class="math notranslate nohighlight">\(\text{Beta}(5, 11)\)</span> riflette il punto di vista femminista secondo il quale la maggioranza dei film non supera il test di Bechdel. Al contrario, la <span class="math notranslate nohighlight">\(\text{Beta}(14,1)\)</span> pone la gran parte della massa della distribuzione a priori su valori <span class="math notranslate nohighlight">\(\pi\)</span> prossimi a 1, e corrisponde quindi alle credenze a priori dell’amica ottimista. Infine, una <span class="math notranslate nohighlight">\(\text{Beta}(1 ,1)\)</span> o <span class="math notranslate nohighlight">\(\mbox{Unif}(0, 1)\)</span>, assegna lo stesso livello di plausibilità a tutti i valori <span class="math notranslate nohighlight">\(\pi \in [0, 1]\)</span>, e corrisponde all’incertezza a priori dell’ignara.</p>
<p>Nell’esempio di <span id="id4">[<a class="reference internal" href="z_biblio.html#id39" title="Alicia A. Johnson, Miles Ott, and Mine Dogucu. Bayes Rules! An Introduction to Bayesian Modeling with R. CRC Press, 2022.">JOD22</a>]</span>, le tre amiche decidono di rivedere un campione di <span class="math notranslate nohighlight">\(n\)</span> film e di registrare <span class="math notranslate nohighlight">\(y\)</span>, ovvero il numero di film che superano il test di Bechdel. Se <span class="math notranslate nohighlight">\(y\)</span> corrisponde al numero di “successi” in un numero fisso di <span class="math notranslate nohighlight">\(n\)</span> prove Bernoulliane i.i.d., allora la dipendenza di <span class="math notranslate nohighlight">\(y\)</span> da <span class="math notranslate nohighlight">\(\pi\)</span> viene specificata da un modello binomiale. Quindi, per ciascuna delle tre amiche è possibile scrivere un modello beta-binomiale</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
Y \mid \pi &amp; \sim \mbox{Bin}(n, \pi)  \notag\\
\pi &amp; \sim \mbox{Beta}(\alpha, \beta) \notag
\end{align}
\end{split}\]</div>
<p>che utilizza diversi parametri <span class="math notranslate nohighlight">\(\alpha\)</span> e <span class="math notranslate nohighlight">\(\beta\)</span> per la distribuzione a priori e che conduce a tre diverse distribuzioni a posteriori per il parametro sconosciuto <span class="math notranslate nohighlight">\(\pi\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\pi \mid (Y = y) \sim \mbox{Beta}(\alpha + y, \beta + n - y).
\]</div>
<p><span id="id5">[<a class="reference internal" href="z_biblio.html#id39" title="Alicia A. Johnson, Miles Ott, and Mine Dogucu. Bayes Rules! An Introduction to Bayesian Modeling with R. CRC Press, 2022.">JOD22</a>]</span> si chiedono come le credenze a priori delle tre amiche influenzano le credenze a posteriori a cui esse giungono dopo avere osservato i dati. Si chiedono inoltre in che modo la dimensione del campione moduli l’influenza della distribuzione a priori sulla distribuzione a posteriori.</p>
<p>Per rispondere a queste domande, <span id="id6">[<a class="reference internal" href="z_biblio.html#id39" title="Alicia A. Johnson, Miles Ott, and Mine Dogucu. Bayes Rules! An Introduction to Bayesian Modeling with R. CRC Press, 2022.">JOD22</a>]</span> consideriamo tre diversi scenari:</p>
<ul class="simple">
<li><p>gli stessi dati osservati, ma distribuzioni a priori diverse;</p></li>
<li><p>dati diversi, ma la stessa distribuzione a priori;</p></li>
<li><p>dati diversi e distribuzioni a priori diverse.</p></li>
</ul>
</section>
<section id="stessi-dati-diverse-distribuzioni-a-priori">
<h2>Stessi dati, diverse distribuzioni a priori<a class="headerlink" href="#stessi-dati-diverse-distribuzioni-a-priori" title="Permalink to this headline">#</a></h2>
<p>Iniziamo con lo scenario che descrive il caso in cui abbiamo gli stessi dati ma diverse distribuzioni a priori. Supponiamo che le tre amiche decidano di guardare insieme 20 film selezionati a caso.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> rpy2.ipython
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = &#39;retina&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">R</span>
suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(janitor))
suppressPackageStartupMessages(library(bayesrules))
suppressPackageStartupMessages(library(patchwork))

data(bechdel, package = &quot;bayesrules&quot;)
set.seed(84735)
bechdel_20 &lt;- bechdel %&gt;% 
  sample_n(20)
</pre></div>
</div>
</div>
</div>
<p>Di questi 20 film, solo il 45% (<span class="math notranslate nohighlight">\(y\)</span> = 9) passa il test di Bechdel.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p>n</p></th>
<th class="head"><p>percent</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>FAIL</p></td>
<td><p>11</p></td>
<td><p>0.55</p></td>
</tr>
<tr class="row-odd"><td><p>PASS</p></td>
<td><p>9</p></td>
<td><p>0.45</p></td>
</tr>
<tr class="row-even"><td><p>Total</p></td>
<td><p>20</p></td>
<td><p>1.00</p></td>
</tr>
</tbody>
</table>
<p>Esaminiamo le tre distribuzioni a posteriori. Per la femminista usiamo una distribuzione a priori <span class="math notranslate nohighlight">\(\text{Beta}(5, 11)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">R</span>
bayesrules::plot_beta_binomial(alpha = 5, beta = 11, y = 9, n = 20) 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/030_balance_prior_post_6_0.png" src="_images/030_balance_prior_post_6_0.png" />
</div>
</div>
<p>Per l’ottimista usiamo una distribuzione a priori <span class="math notranslate nohighlight">\(\text{Beta}(14, 1)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">R</span>
bayesrules:::plot_beta_binomial(alpha = 14, beta = 1, y = 9, n = 20) 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/030_balance_prior_post_8_0.png" src="_images/030_balance_prior_post_8_0.png" />
</div>
</div>
<p>Infine, per l’ignara usiamo una distribuzione a priori <span class="math notranslate nohighlight">\(\text{Beta}(1, 1)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">R</span>
bayesrules:::plot_beta_binomial(alpha = 1, beta = 1, y = 9, n = 20)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/030_balance_prior_post_10_0.png" src="_images/030_balance_prior_post_10_0.png" />
</div>
</div>
<p>Per calcolare la distribuzione a posteriori, ho usato le funzioni del pacchetto <code class="docutils literal notranslate"><span class="pre">bayesrules</span></code>. Ma per lo schema beta-binomiale è facile trovare i parametri della distribuzione a posteriori. Per esempio, nel caso dell’amica femminista, la distribuzione a posteriori è una Beta di parametri</p>
<div class="math notranslate nohighlight">
\[
\alpha_{post} = \alpha_{prior} + y = 5+9 = 14
\]</div>
<p>e</p>
<div class="math notranslate nohighlight">
\[
\beta_{post} = \beta_{prior} + n - y = 11 + 20 - 9 = 22.
\]</div>
<p>L’aggiornamento bayesiano indica che le tre amiche otterranno valori molto diversi per la media (o la moda) a posteriori del parametro <span class="math notranslate nohighlight">\(\pi\)</span>. Dunque, anche dopo avere visto 20 film, le tre amiche non si trovano d’accordo su quale sia la proporzione di film che passano il test di Bechdel.</p>
<p>Questo non dovrebbe sorprenderci. L’amica ottimista aveva opinioni molto forti sul valore di <span class="math notranslate nohighlight">\(\pi\)</span> e i <em>pochi</em> nuovi dati che le sono stati forniti non sono riusciti a convincerla a cambiare idea: pensa ancora che i valori <span class="math notranslate nohighlight">\(\pi &gt; 0.5\)</span> siano i più credibili. Lo stesso si può dire, all’estremo opposto, dell’amica femminista: anche lei continua a pensare che i valori <span class="math notranslate nohighlight">\(\pi &lt; 0.5\)</span> siano i più credibili. Infine, l’ignara non aveva nessuna opinione a priori su <span class="math notranslate nohighlight">\(\pi\)</span> e, anche dopo avere visto 20 film, continua a pensare che il valore <span class="math notranslate nohighlight">\(\pi\)</span> più credibile sia quello intermedio, nell’intorno di 0.5.</p>
<p>In conclusione, quando i dati sono deboli (ovvero, quando il campione è piccolo), l’aggiornamento bayesiano altera solo in piccola misura le distribuzioni a priori.</p>
</section>
<section id="dati-diversi-stessa-distribuzione-a-priori">
<h2>Dati diversi, stessa distribuzione a priori<a class="headerlink" href="#dati-diversi-stessa-distribuzione-a-priori" title="Permalink to this headline">#</a></h2>
<p>Supponiamo ora che l’amica ottimista abbia tre amiche, Maria, Anna e Sara, tutte ottimiste come lei. L’ottimista chiede a Maria, Anna e Sara di fare loro stesse l’esperimento descritto in precedenza. Maria guarda 13 film; di questi 6 passano il test di Bechdel. Anna guarda 63 film; di questi 29 passano il test di Bechdel. Sara guarda 99 film; di questi 46 passano il test di Bechdel.</p>
<p>Supponiamo che Maria, Anna e Sara condividano la stessa credenza a priori su <span class="math notranslate nohighlight">\(\pi\)</span>: ovvero, Beta(14, 1). In tali circostanze e, alla luce dei dati osservati, cosa possiamo dire delle tre distribuzioni a posteriori?</p>
<p>Nella figura è rappresentato l’aggiornamento bayesiano per le credenze di Maria (sinistra, 16 film), Anna (centro, 63 film) e Sara (destra, 99 film).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">R</span>
p1 &lt;- bayesrules:::plot_beta_binomial(
  alpha = 14, beta = 1, y = 6, n = 13
  ) + 
  theme(legend.position = &quot;none&quot;) 
p2 &lt;- bayesrules:::plot_beta_binomial(
  alpha = 14, beta = 1, y = 29, n = 63
  ) + 
  theme(legend.position = &quot;none&quot;) 
p3 &lt;- bayesrules:::plot_beta_binomial(
  alpha = 14, beta = 1, y = 46, n = 99
  ) +
  theme(legend.position = &quot;none&quot;) 
p1 + p2 + p3
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/030_balance_prior_post_12_0.png" src="_images/030_balance_prior_post_12_0.png" />
</div>
</div>
<p>In conclusione, dalla figura precedente notiamo due cose. Primo, all’aumentare delle informazioni disponibili (ovvero, al crescere dell’ampiezza del campione), la distribuzione a posteriori si allontana sempre di più dalla distribuzione a priori e si avvicina sempre di più alla verosimiglianza. Secondo, all’aumentare dell’ampiezza del campione la varianza della distribuzione a posteriori diminuisce sempre di più — ovvero, diminuisce l’incertezza su quelli che sono i valori <span class="math notranslate nohighlight">\(\pi\)</span> più credibili.</p>
</section>
<section id="dati-diversi-diverse-distribuzioni-a-priori">
<h2>Dati diversi, diverse distribuzioni a priori<a class="headerlink" href="#dati-diversi-diverse-distribuzioni-a-priori" title="Permalink to this headline">#</a></h2>
<p>La figura seguente illustra le distribuzioni a posteriori che si ottengono incrociando tre diversi set di dati (<span class="math notranslate nohighlight">\(y\)</span> = 6, <span class="math notranslate nohighlight">\(n\)</span> = 13;, <span class="math notranslate nohighlight">\(y\)</span> = 29, <span class="math notranslate nohighlight">\(n\)</span> = 63; <span class="math notranslate nohighlight">\(y\)</span> = 66, <span class="math notranslate nohighlight">\(n\)</span> = 99) con tre diverse distribuzioni a priori, <span class="math notranslate nohighlight">\(\mbox{Beta}(14, 1)\)</span>, <span class="math notranslate nohighlight">\(\mbox{Beta}(5, 11)\)</span> e <span class="math notranslate nohighlight">\(\mbox{Beta}(1, 1)\)</span>. Sulle colonne della figura (a partire da sinistra) i dati utilizzati sono, rispettivamente, (y = 6, n = 13), (y = 29, n = 63) e (y = 66, n = 99). Sulle righe (a partire dall’alto), le distribuzioni a priori usate sono: Beta(14, 1), Beta(5, 11) e Beta(1, 1).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">R</span>
p1 &lt;- bayesrules:::plot_beta_binomial(
  alpha = 14, beta = 1, y = 6, n = 13
  ) +
  theme(legend.position = &quot;none&quot;) 
p2 &lt;- bayesrules:::plot_beta_binomial(
  alpha = 14, beta = 1, y = 29, n = 63
  ) +
  theme(legend.position = &quot;none&quot;) 
p3 &lt;- bayesrules:::plot_beta_binomial(
  alpha = 14, beta = 1, y = 46, n = 99
  ) +
  theme(legend.position = &quot;none&quot;) 
p4 &lt;- bayesrules:::plot_beta_binomial(
  alpha = 5, beta = 11, y = 6, n = 13
  ) +
  theme(legend.position = &quot;none&quot;) 
p5 &lt;- bayesrules:::plot_beta_binomial(
  alpha = 5, beta = 11, y = 29, n = 63
  ) +
  theme(legend.position = &quot;none&quot;) 
p6 &lt;- bayesrules:::plot_beta_binomial(
  alpha = 5, beta = 11, y = 46, n = 99
  ) +
  theme(legend.position = &quot;none&quot;) 
p7 &lt;- bayesrules:::plot_beta_binomial(
  alpha = 1, beta = 1, y = 6, n = 13
  ) +
  theme(legend.position = &quot;none&quot;) 
p8 &lt;- bayesrules:::plot_beta_binomial(
  alpha = 1, beta = 1, y = 29, n = 63
  ) +
  theme(legend.position = &quot;none&quot;) 
p9 &lt;- bayesrules:::plot_beta_binomial(
  alpha = 1, beta = 1, y = 46, n = 99
  ) +
  theme(legend.position = &quot;none&quot;) 
(p1 + p2 + p3) / (p4 + p5 + p6) / (p7 + p8 + p9)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/030_balance_prior_post_14_0.png" src="_images/030_balance_prior_post_14_0.png" />
</div>
</div>
<p>In conclusione, la figura precedente ci consente di concludere quanto segue: se il campione è grande, una distribuzione a priori debolmente informativa ha uno scarso effetto sulla distribuzione a posteriori; se il campione è piccolo, invece, anche una distribuzione a priori debolmente informativa ha un grande effetto sulla distribuzione a posteriori.</p>
</section>
<section id="collegare-le-intuizioni-alla-teoria">
<h2>Collegare le intuizioni alla teoria<a class="headerlink" href="#collegare-le-intuizioni-alla-teoria" title="Permalink to this headline">#</a></h2>
<p>Il compromesso che abbiamo osservato nell’esempio precedente, ovvero l’equilibrio che si ottiene tra la distribuzione a priori e le evidenze fornite dai dati, è molto vicino alle nostre intuizioni. Ma è anche il frutto di una necessità matematica. È infatti possibile riscrivere l’eq. <a class="reference internal" href="029_conjugate_families.html#equation-eq-ev-post-beta-bin-1">(63)</a> nel modo seguente</p>
<div class="math notranslate nohighlight" id="equation-eq-ev-post-beta-bin">
<span class="eqno">(64)<a class="headerlink" href="#equation-eq-ev-post-beta-bin" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{align}
\mathbb{E}_{\text{post}} &amp;[\text{Beta}(\alpha + y, \beta + n - y)] = \frac{\alpha + y}{\alpha + \beta +n}\notag\\ 
&amp;= \frac{a+b}{a+b+n} \cdot \frac{a}{a+b} + \frac{n}{a+b+n} \cdot \frac{y}{n}.
\end{align}
\end{split}\]</div>
<p>L’eq. <a class="reference internal" href="#equation-eq-ev-post-beta-bin">(64)</a> indica che il valore atteso a posteriori è una media pesata fra il valore atteso a priori <span class="math notranslate nohighlight">\(\left( \frac{\alpha}{\alpha+\beta}\right)\)</span> e la proporzione osservata di successi <span class="math notranslate nohighlight">\(\left(\frac{y}{n}\right)\)</span>. I pesi sono <span class="math notranslate nohighlight">\(\left( \frac{\alpha+\beta}{\alpha+\beta+n}\right)\)</span> e <span class="math notranslate nohighlight">\(\left( \frac{n}{\alpha+\beta+n}\right)\)</span>. Quindi, quando <span class="math notranslate nohighlight">\(n\)</span> è grande rispetto ad <span class="math notranslate nohighlight">\(\alpha + \beta\)</span>, contano molto i dati osservati e contano poco le credenze a priori. Viceversa, quando <span class="math notranslate nohighlight">\(n\)</span> è piccolo rispetto a <span class="math notranslate nohighlight">\(\alpha + \beta\)</span>, i dati contano poco rispetto alla credenza a priori.</p>
<p>Queste osservazioni ci fanno capire come scegliere i parametri <span class="math notranslate nohighlight">\(\alpha\)</span> e <span class="math notranslate nohighlight">\(\beta\)</span>: se vogliamo assumere una totale ignoranza rispetto al fenomeno in esame, la scelta coerente è <span class="math notranslate nohighlight">\(\alpha = \beta = 1\)</span> (ogni valore di <span class="math notranslate nohighlight">\(\theta\)</span> è ugualmente credibile); se invece abbiamo delle forti credenze a priori, allora possiamo scegliere <span class="math notranslate nohighlight">\(\alpha\)</span> così che sia uguale al valore atteso a priori, mentre <span class="math notranslate nohighlight">\(\alpha + \beta\)</span> esprime l’importanza che diamo all’informazione a priori: maggiore è il valore di <span class="math notranslate nohighlight">\(\alpha + \beta\)</span>, tanti più dati serviranno per allontanare la distribuzione a posteriori dalla distribuzione a priori. Infine, se <span class="math notranslate nohighlight">\(n\)</span> è grande, la distribuzione a posteriori avrà una scarsa influenza sulla distribuzione a priori, a meno di scelte estreme.</p>
</section>
<section id="commenti-e-considerazioni-finali">
<h2>Commenti e considerazioni finali<a class="headerlink" href="#commenti-e-considerazioni-finali" title="Permalink to this headline">#</a></h2>
<p>La conclusione che possiamo trarre dall’esempio discusso da <span id="id7">[<a class="reference internal" href="z_biblio.html#id39" title="Alicia A. Johnson, Miles Ott, and Mine Dogucu. Bayes Rules! An Introduction to Bayesian Modeling with R. CRC Press, 2022.">JOD22</a>]</span> è molto chiara: l’aggiornamento bayesiano può essere paragonato ai processi di ragionamento del senso comune. Quando le nuove evidenze (i dati) sono deboli, non c’è ragione di cambiare idea (le nostre credenze “a posteriori” sono molto simili a ciò che pensavamo prima di avere osservato i dati). Quando le nuove evidenze sono irrefutabili, invece, è necessario modificare le nostre credenze sulla base di ciò che ci dicono i dati, quali che siano le nostre credenze pregresse — non farlo significherebbe vivere in un mondo di fantasia e avere scarse possibilità di sopravvivere nel mondo empirico. L’aggiornamento bayesiano, dunque, non fa altro che esprimere in maniera quantitativa e precisa ciò che ci dicono le nostre intuizioni.</p>
<p>Alla luce di quanto detto sopra, è sorprendente che l’approccio frequentista neghi questa logica. I test frequentisti non tengono conto delle conoscenze pregresse. Dunque, se un test frequentista, calcolato su un piccolo campione (ovvero, quando i dati sono molto deboli), suggerisce che dovremmo farci un’opinione di un certo tipo sul fenomeno in esame, l’indicazione è quella di prendere seriamente in considerazione il risultato del test (ovvero di modificare le nostre credenze) <em>quali che siano le evidenze precedenti</em> – le quali, in generale, potrebbero mostrare che il risultato del test non ha alcun senso. Un tale modo di pensare viene preso sul serio da coloro che, nella comunità scientifica, seguono l’approccio frequentista. Dato che in questo Capitolo abbiamo parlato di fumetti, concluderei dicendo che il significato della presente discussione è catturata nella maniera più chiara possibile in questa famosa <a class="reference external" href="https://xkcd.com/1132/">striscia</a>.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="029_conjugate_families.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Distribuzioni coniugate</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="036_metropolis.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Approssimazione della distribuzione a posteriori</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Corrado Caudek<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>